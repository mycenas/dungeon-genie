<div class="main-content">
  <div class="new-character-container">
    <div class="new-character-form-content">
      <%= form_with(model: @character, local: true, html: { class: "new-character-form" }) do |f| %>

        <% if @character.errors.any? %>
          <div id="error_explanation">
            <h2><%= pluralize(@character.errors.count, "error") %> prohibited this character from being saved:</h2>
            <ul>
            <% @character.errors.full_messages.each do |message| %>
              <li><%= message %></li>
            <% end %>
            </ul>
          </div>
        <% end %>

        <div class="form-field">
          <%= f.label :name %>
          <%= f.text_field :name %>
        </div>

        <div class="form-field">
          <%= f.label :race %>
          <%= f.select :race_id, Race.all.collect { |r| [r.name, r.id] } %>
        </div>

        <div class="form-field">
          <%= f.label :character_class %>
          <%= f.select :character_class_id, CharacterClass.all.collect { |c| [c.name, c.id] } %>
        </div>

            <!-- Cleric Equipment -->
    <div class="equipment-options" data-class="cleric">
        <%= f.label :equipment, "Equipment (Cleric)" %>
        <%= f.select :equipment, ["A mace", "Warhammer"] %>
        <%= f.select :equipment, ["Scale mail", "Leather armor", "Chain mail"] %>
        <%= f.select :equipment, ["A light crossbow and 20 bolts", "Any simple weapon"] %>
        <%= f.select :equipment, ["A priest's pack", "An explorer's pack"] %>
        <%= f.select :equipment, ["Shield and a holy symbol"]  %>
    </div>

    <!-- Druid Equipment -->
    <div class="equipment-options" data-class="druid">
        <%= f.label :equipment, "Equipment (Druid)" %>
        <%= f.select :equipment, ["A wooden shield", "Any simple weapon"] %>
        <%= f.select :equipment, ["A scimitar", "Any simple melee weapon"] %>
        <%= f.select :equipment, ["Leather armor, an explorer's pack, and a druidic focus"] %> 
    </div>

    <!-- Fighter Equipment -->
    <div class="equipment-options" data-class="fighter">
        <%= f.label :equipment, "Equipment (Fighter)" %>
        <%= f.select :equipment, ["Chain mail", "Leather armor, longbow, and 20 arrows"] %>
        <%= f.select :equipment, ["A martial weapon and a shield", "Two martial weapons"] %>
        <%= f.select :equipment, ["A light crossbow and 20 bolts", "Two handaxes"] %>
        <%= f.select :equipment, ["A dungeoneer's pack", "An explorer's pack"] %>
    </div>

    <!-- Warlock Equipment -->
    <div class="equipment-options" data-class="warlock">
        <%= f.label :equipment, "Equipment (Warlock)" %>
        <%= f.select :equipment, ["A light crossbow and 20 bolts", "Any simple weapon"] %>
        <%= f.select :equipment, ["A component pouch", "An arcane focus"] %>
        <%= f.select :equipment, ["A scholar's pack", "A dungeoneer's pack"] %>
        <%= f.select :equipment, ["Leather armor, any simple weapon, and two daggers"] %>
    </div>

        <div class="form-field">
          <%= f.label :max_hp %>
          <%= f.number_field :max_hp %>
        </div>

        <div class="form-field">
          <%= f.label :armor_class %>
          <%= f.text_field :armor_class %>
        </div>

        <div class="form-field">
          <%= f.label :gender %>
          <%= f.select :gender, ["Male", "Female", "Other"] %>
        </div>
      
        <div class="form-field">
          <%= f.label :weapons %>
          <%= f.text_area :weapons, rows: 3 %>
        </div>

        <div class="form-field">
          <%= f.label :languages %>
          <%= f.text_area :languages, rows: 3 %>
        </div>

        <div class="actions">
          <%= f.submit %>
        </div>
      <% end %>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const classDropdown = document.querySelector('[name="character[character_class_id]"]');
    const equipmentGroups = document.querySelectorAll('.equipment-options');

    classDropdown.addEventListener('change', function() {
        // Hide all equipment groups
        equipmentGroups.forEach(group => group.style.display = 'none');

        // Show the equipment group for the selected class
        const selectedClass = classDropdown.options[classDropdown.selectedIndex].text.toLowerCase();
        const targetGroup = document.querySelector(`.equipment-options[data-class="${selectedClass}"]`);
        if (targetGroup) {
            targetGroup.style.display = 'block';
        }
    });
});

</script>
